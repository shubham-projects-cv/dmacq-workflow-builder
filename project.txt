File: .gitignore
------------------------
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/versions

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# env files (can opt-in for committing if needed)
.env*

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts

File: app/globals.css
------------------------
@import "reactflow/dist/style.css";
@import "tailwindcss";

:root {
  --background: #ffffff;
  --foreground: #171717;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #0a0a0a;
    --foreground: #ededed;
  }
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: Arial, Helvetica, sans-serif;
}

/* Allow node action buttons to overflow */

.react-flow__node {
  overflow: visible !important;
}

File: app/layout.tsx
------------------------
import type { Metadata } from "next";
import { Geist, Geist_Mono } from "next/font/google";
import "./globals.css";

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
});

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
});

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body
        className={`${geistSans.variable} ${geistMono.variable} antialiased`}
      >
        {children}
      </body>
    </html>
  );
}

File: app/page.tsx
------------------------
export default function Home() {
  return (
    <main className="h-screen w-screen flex items-center justify-center">
      <h1 className="text-2xl font-bold">Workflow Builder ðŸš€</h1>
    </main>
  );
}

File: app/workflow/page.tsx
------------------------
"use client";

import React, { useCallback } from "react";

import ReactFlow, {
  Controls,
  Background,
  addEdge,
  Connection,
  ReactFlowProvider,
} from "reactflow";

import StartNode from "@/components/nodes/StartNode";
import ApprovalNode from "@/components/nodes/ApprovalNode";
import EndNode from "@/components/nodes/EndNode";

import DeletableEdge from "@/components/edges/DeletableEdge";

import WorkflowLayout from "@/components/WorkflowLayout";
import Sidebar from "@/components/Sidebar";
import NodeSettings from "@/components/NodeSettings";

import { useWorkflowStore } from "@/store/workflowStore";

export default function WorkflowPage() {
  const nodes = useWorkflowStore((s) => s.workflow.nodes);

  const edges = useWorkflowStore((s) => s.workflow.edges);

  const onNodesChange = useWorkflowStore((s) => s.onNodesChange);

  const onEdgesChange = useWorkflowStore((s) => s.onEdgesChange);

  const addStoreEdge = useWorkflowStore((s) => s.addEdge);

  const selectNode = useWorkflowStore((s) => s.selectNode);

  const closeSettings = useWorkflowStore((s) => s.closeSettings);

  const settingsId = useWorkflowStore((s) => s.settingsNodeId);

  const onConnect = useCallback(
    (params: Connection) => {
      const e = addEdge(params, []);

      if (e.length) addStoreEdge(e[0]);
    },
    [addStoreEdge],
  );

  const nodeTypes = {
    start: StartNode,
    approval: ApprovalNode,
    end: EndNode,
  };

  const edgeTypes = {
    deletable: DeletableEdge,
  };

  const mappedEdges = edges.map((e) => ({
    ...e,
    type: "deletable",
  }));

  return (
    <ReactFlowProvider>
      <WorkflowLayout
        sidebar={<Sidebar />}
        rightPanel={settingsId ? <NodeSettings /> : null}
      >
        <ReactFlow
          nodes={nodes}
          edges={mappedEdges}
          nodeTypes={nodeTypes}
          edgeTypes={edgeTypes}
          onNodesChange={onNodesChange}
          onEdgesChange={onEdgesChange}
          onConnect={onConnect}
          onNodeClick={(_, n) => selectNode(n.id)}
          onPaneClick={() => {
            selectNode(null);
            closeSettings();
          }}
          fitView
        >
          <Controls />
          <Background />
        </ReactFlow>
      </WorkflowLayout>
    </ReactFlowProvider>
  );
}

File: components/NodeSettings.tsx
------------------------
"use client";

import { X } from "lucide-react";
import { ChangeEvent } from "react";

import { useWorkflowStore } from "@/store/workflowStore";

export default function NodeSettings() {
  const nodeId = useWorkflowStore((s) => s.settingsNodeId);
  const nodes = useWorkflowStore((s) => s.workflow.nodes);

  const close = useWorkflowStore((s) => s.closeSettings);
  const updateNodeData = useWorkflowStore((s) => s.updateNodeData);

  if (!nodeId) return null;

  const node = nodes.find((n) => n.id === nodeId);

  if (!node) return null;

  const handleChange =
    (field: string) => (e: ChangeEvent<HTMLInputElement>) => {
      updateNodeData(node.id, {
        [field]: e.target.value,
      });
    };

  return (
    <div className="w-72 bg-white border-l p-4 h-full">
      {/* Header */}
      <div className="flex items-center justify-between mb-4">
        <h3 className="font-semibold">Node Settings</h3>

        <button onClick={close}>
          <X size={18} />
        </button>
      </div>

      {/* Form */}
      <div className="space-y-4 text-sm">
        <div>
          <label className="block mb-1 font-medium">Label</label>

          <input
            value={node.data?.label || ""}
            onChange={handleChange("label")}
            className="w-full border rounded px-2 py-1"
          />
        </div>

        <div>
          <label className="block mb-1 font-medium">Email</label>

          <input
            value={node.data?.email || ""}
            onChange={handleChange("email")}
            className="w-full border rounded px-2 py-1"
          />
        </div>

        <div>
          <label className="block mb-1 font-medium">Approver</label>

          <input
            value={node.data?.approver || ""}
            onChange={handleChange("approver")}
            className="w-full border rounded px-2 py-1"
          />
        </div>
      </div>
    </div>
  );
}

File: components/Sidebar.tsx
------------------------
"use client";

import { X } from "lucide-react";
import { useReactFlow } from "reactflow";

import { useWorkflowStore } from "@/store/workflowStore";

export default function Sidebar() {
  const addNode = useWorkflowStore((s) => s.addNode);
  const closeLeft = useWorkflowStore((s) => s.closeLeft);

  const { getViewport, getZoom } = useReactFlow();

  const handleAdd = (type: string) => {
    const viewport = getViewport();
    const zoom = getZoom();

    const x = (-viewport.x + window.innerWidth / 2) / zoom;

    const y = (-viewport.y + window.innerHeight / 2) / zoom;

    addNode(type, { x, y });
  };

  return (
    <div className="p-4 h-full bg-white flex flex-col">
      {/* Header */}
      <div className="flex items-center justify-between mb-4">
        <h2 className="font-semibold text-lg">Nodes</h2>

        <button onClick={closeLeft}>
          <X size={18} />
        </button>
      </div>

      {/* Buttons */}
      <div className="space-y-3">
        <button
          onClick={() => handleAdd("Start")}
          className="w-full border rounded px-3 py-2 hover:bg-gray-100"
        >
          Start
        </button>

        <button
          onClick={() => handleAdd("Approval")}
          className="w-full border rounded px-3 py-2 hover:bg-gray-100"
        >
          Approval
        </button>

        <button
          onClick={() => handleAdd("End")}
          className="w-full border rounded px-3 py-2 hover:bg-gray-100"
        >
          End
        </button>
      </div>
    </div>
  );
}

File: components/WorkflowLayout.tsx
------------------------
"use client";

import { ReactNode } from "react";
import { Plus } from "lucide-react";
import { useWorkflowStore } from "@/store/workflowStore";

export default function WorkflowLayout({
  sidebar,
  children,
  rightPanel,
}: {
  sidebar: ReactNode;
  children: ReactNode;
  rightPanel?: ReactNode;
}) {
  const isLeftOpen = useWorkflowStore((s) => s.isLeftOpen);
  const toggleLeft = useWorkflowStore((s) => s.toggleLeft);

  return (
    <div className="h-screen w-screen flex overflow-hidden relative bg-white">
      {/* Left Sidebar */}
      {isLeftOpen && (
        <div className="w-64 border-r bg-white text-gray-900">{sidebar}</div>
      )}

      {/* Reopen Button */}
      {!isLeftOpen && (
        <button
          onClick={toggleLeft}
          className="absolute top-4 left-4 z-50 bg-white border rounded p-2 shadow hover:bg-gray-100"
        >
          <Plus size={18} />
        </button>
      )}

      {/* Canvas */}
      <div className="flex-1 relative">{children}</div>

      {/* Right Panel */}
      {rightPanel && (
        <div className="w-72 border-l bg-white text-gray-900">{rightPanel}</div>
      )}
    </div>
  );
}

File: components/nodes/ApprovalNode.tsx
------------------------
"use client";

import { Handle, Position } from "reactflow";
import { CheckCircle, Trash2, Copy, Settings } from "lucide-react";

import { useWorkflowStore } from "@/store/workflowStore";

type Props = {
  id: string;
  data: {
    label?: string;
    approver?: string;
  };
};

export default function ApprovalNode({ id, data }: Props) {
  const deleteNode = useWorkflowStore((s) => s.deleteNode);
  const duplicateNode = useWorkflowStore((s) => s.duplicateNode);
  const openSettings = useWorkflowStore((s) => s.openSettings);

  const activeId = useWorkflowStore((s) => s.settingsNodeId);

  const active = activeId === id;

  return (
    <div className="relative flex min-w-[180px] max-w-[180px] h-[52px] rounded-lg border shadow-sm bg-white">
      {active && (
        <div className="absolute -right-11 top-1/2 -translate-y-1/2 flex flex-col gap-2 z-50">
          <button
            onClick={() => openSettings(id)}
            className="p-2 bg-blue-500 text-white rounded-full"
          >
            <Settings size={14} />
          </button>

          <button
            onClick={() => duplicateNode(id)}
            className="p-2 bg-blue-500 text-white rounded-full"
          >
            <Copy size={14} />
          </button>

          <button
            onClick={() => deleteNode(id)}
            className="p-2 bg-red-500 text-white rounded-full"
          >
            <Trash2 size={14} />
          </button>
        </div>
      )}

      <div className="bg-emerald-600 px-3 flex items-center justify-center">
        <CheckCircle className="text-white" size={18} />
      </div>

      <div className="p-2 flex-1">
        <div className="text-sm font-semibold truncate">
          {data.label || "Approval"}
        </div>

        {data.approver && (
          <div className="text-[11px] text-gray-500">ðŸ‘¤ {data.approver}</div>
        )}
      </div>

      <Handle type="target" position={Position.Top} />
      <Handle type="source" position={Position.Bottom} />
    </div>
  );
}

File: components/nodes/EndNode.tsx
------------------------
"use client";

import { Handle, Position } from "reactflow";
import { Square, Trash2, Copy, Settings } from "lucide-react";

import { useWorkflowStore } from "@/store/workflowStore";

type Props = {
  id: string;
  data: {
    label?: string;
  };
};

export default function EndNode({ id, data }: Props) {
  const deleteNode = useWorkflowStore((s) => s.deleteNode);
  const duplicateNode = useWorkflowStore((s) => s.duplicateNode);
  const openSettings = useWorkflowStore((s) => s.openSettings);

  const activeId = useWorkflowStore((s) => s.settingsNodeId);

  const active = activeId === id;

  return (
    <div className="relative flex items-center min-w-[180px] max-w-[180px] h-[52px] px-3 rounded-md border shadow-sm bg-white">
      {active && (
        <div className="absolute -right-11 top-1/2 -translate-y-1/2 flex flex-col gap-2 z-50">
          <button
            onClick={() => openSettings(id)}
            className="p-2 bg-blue-500 text-white rounded-full"
          >
            <Settings size={14} />
          </button>

          <button
            onClick={() => duplicateNode(id)}
            className="p-2 bg-blue-500 text-white rounded-full"
          >
            <Copy size={14} />
          </button>

          <button
            onClick={() => deleteNode(id)}
            className="p-2 bg-red-500 text-white rounded-full"
          >
            <Trash2 size={14} />
          </button>
        </div>
      )}

      <Square size={14} className="text-indigo-700 mr-2" fill="currentColor" />

      <span className="text-sm font-semibold truncate">
        {data.label || "End"}
      </span>

      <Handle type="target" position={Position.Top} />
    </div>
  );
}

File: components/nodes/StartNode.tsx
------------------------
"use client";

import { Handle, Position } from "reactflow";
import { FileText, Trash2, Copy, Settings } from "lucide-react";

import { useWorkflowStore } from "@/store/workflowStore";

type Props = {
  id: string;
  data: {
    label?: string;
    subLabel?: string;
  };
};

export default function StartNode({ id, data }: Props) {
  const deleteNode = useWorkflowStore((s) => s.deleteNode);
  const duplicateNode = useWorkflowStore((s) => s.duplicateNode);
  const openSettings = useWorkflowStore((s) => s.openSettings);

  const activeId = useWorkflowStore((s) => s.settingsNodeId);

  const active = activeId === id;

  return (
    <div className="relative flex min-w-[180px] max-w-[180px] h-[52px] rounded-lg border shadow-sm bg-white">
      {/* Actions */}
      {active && (
        <div className="absolute -right-11 top-1/2 -translate-y-1/2 flex flex-col gap-2 z-50">
          <button
            onClick={() => openSettings(id)}
            className="p-2 bg-blue-500 text-white rounded-full"
          >
            <Settings size={14} />
          </button>

          <button
            onClick={() => duplicateNode(id)}
            className="p-2 bg-blue-500 text-white rounded-full"
          >
            <Copy size={14} />
          </button>

          <button
            onClick={() => deleteNode(id)}
            className="p-2 bg-red-500 text-white rounded-full"
          >
            <Trash2 size={14} />
          </button>
        </div>
      )}

      {/* Icon */}
      <div className="bg-orange-500 px-3 flex items-center justify-center">
        <FileText className="text-white" size={18} />
      </div>

      {/* Text */}
      <div className="p-2 flex-1">
        <div className="text-[11px] text-gray-500">{data.subLabel}</div>

        <div className="text-sm font-semibold truncate">{data.label}</div>
      </div>

      <Handle type="source" position={Position.Bottom} />
    </div>
  );
}

File: eslint.config.mjs
------------------------
import { defineConfig, globalIgnores } from "eslint/config";
import nextVitals from "eslint-config-next/core-web-vitals";
import nextTs from "eslint-config-next/typescript";

const eslintConfig = defineConfig([
  ...nextVitals,
  ...nextTs,
  // Override default ignores of eslint-config-next.
  globalIgnores([
    // Default ignores of eslint-config-next:
    ".next/**",
    "out/**",
    "build/**",
    "next-env.d.ts",
  ]),
]);

export default eslintConfig;

File: next.config.ts
------------------------
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  /* config options here */
  reactCompiler: true,
};

export default nextConfig;

File: package.json
------------------------
{
  "name": "workflow-builder",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint"
  },
  "dependencies": {
    "clsx": "^2.1.1",
    "lucide-react": "^0.563.0",
    "next": "16.1.4",
    "react": "19.2.3",
    "react-dom": "19.2.3",
    "reactflow": "^11.11.4",
    "tailwind-merge": "^3.4.0",
    "zustand": "^5.0.10"
  },
  "devDependencies": {
    "@tailwindcss/postcss": "^4",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "babel-plugin-react-compiler": "1.0.0",
    "eslint": "^9",
    "eslint-config-next": "16.1.4",
    "tailwindcss": "^4",
    "typescript": "^5"
  }
}

File: postcss.config.mjs
------------------------
const config = {
  plugins: {
    "@tailwindcss/postcss": {},
  },
};

export default config;

File: store/workflowStore.ts
------------------------
import { create } from "zustand";

import {
  Node,
  Edge,
  NodeChange,
  EdgeChange,
  applyNodeChanges,
  applyEdgeChanges,
} from "reactflow";

/* ---------------- Types ---------------- */

type Position = {
  x: number;
  y: number;
};

type NodeData = {
  label?: string;
  subLabel?: string;
  email?: string;
  approver?: string;
  nodeType?: string;
};

type WorkflowMeta = {
  version: string;
  createdBy: string;
  updatedAt: string;
};

export type WorkflowJSON = {
  nodes: Node<NodeData>[];
  edges: Edge[];
  meta: WorkflowMeta;
};

type WorkflowState = {
  workflow: WorkflowJSON;

  // âœ… Selection
  activeNodeId: string | null;
  activeEdgeId: string | null;

  // âœ… Settings panel
  settingsNodeId: string | null;

  isLeftOpen: boolean;

  /* ReactFlow */

  onNodesChange: (c: NodeChange[]) => void;
  onEdgesChange: (c: EdgeChange[]) => void;

  /* Selection */

  selectNode: (id: string | null) => void;
  selectEdge: (id: string | null) => void;

  openSettings: (id: string) => void;
  closeSettings: () => void;

  /* UI */

  toggleLeft: () => void;
  closeLeft: () => void;

  /* Workflow */

  addNode: (type: string, pos?: Position) => void;
  addEdge: (edge: Edge) => void;

  deleteNode: (id: string) => void;
  deleteEdge: (id: string) => void;

  duplicateNode: (id: string) => void;

  updateNodeData: (id: string, data: Partial<NodeData>) => void;

  setWorkflow: (wf: WorkflowJSON) => void;
};

/* ---------------- Storage ---------------- */

const KEY = "workflow-builder:v1";

/* ---------------- Helpers ---------------- */

function load(): WorkflowJSON | null {
  if (typeof window === "undefined") return null;

  try {
    const raw = localStorage.getItem(KEY);

    if (!raw) return null;

    return JSON.parse(raw);
  } catch {
    return null;
  }
}

function save(wf: WorkflowJSON): void {
  if (typeof window === "undefined") return;

  localStorage.setItem(KEY, JSON.stringify(wf));
}

function empty(): WorkflowJSON {
  return {
    nodes: [
      {
        id: "start",
        type: "start",
        position: { x: 300, y: 120 },
        data: {
          label: "Start",
          subLabel: "Starting Point",
          nodeType: "start",
        },
      },
    ],

    edges: [],

    meta: {
      version: "1.0.0",
      createdBy: "Workflow Builder",
      updatedAt: new Date().toISOString(),
    },
  };
}

/* ---------------- Store ---------------- */

export const useWorkflowStore = create<WorkflowState>((set, get) => {
  const saved = load();

  const initial = saved ?? empty();

  const persist = () => {
    const wf = get().workflow;

    save({
      ...wf,
      meta: {
        ...wf.meta,
        updatedAt: new Date().toISOString(),
      },
    });
  };

  return {
    workflow: initial,

    /* Selection */

    activeNodeId: null,
    activeEdgeId: null,

    settingsNodeId: null,

    isLeftOpen: true,

    /* ReactFlow */

    onNodesChange: (changes) => {
      const nodes = applyNodeChanges(changes, get().workflow.nodes);

      set((s) => ({
        workflow: { ...s.workflow, nodes },
      }));

      persist();
    },

    onEdgesChange: (changes) => {
      const edges = applyEdgeChanges(changes, get().workflow.edges);

      set((s) => ({
        workflow: { ...s.workflow, edges },
      }));

      persist();
    },

    /* Selection */

    selectNode: (id) => {
      set({
        activeNodeId: id,
        activeEdgeId: null,
      });
    },

    selectEdge: (id) => {
      set({
        activeEdgeId: id,
        activeNodeId: null,
      });
    },

    openSettings: (id) => {
      set({
        settingsNodeId: id,
        activeNodeId: id,
      });
    },

    closeSettings: () => {
      set({ settingsNodeId: null });
    },

    /* UI */

    toggleLeft: () => {
      set({ isLeftOpen: !get().isLeftOpen });
    },

    closeLeft: () => {
      set({ isLeftOpen: false });
    },

    /* Workflow */

    addNode: (type, pos) => {
      const t = type.toLowerCase();

      const node: Node<NodeData> = {
        id: crypto.randomUUID(),

        type: t,

        position: pos ?? { x: 0, y: 0 },

        data: {
          label: type,
          nodeType: t,
        },
      };

      set((s) => ({
        workflow: {
          ...s.workflow,
          nodes: [...s.workflow.nodes, node],
        },
      }));

      persist();
    },

    addEdge: (edge) => {
      set((s) => ({
        workflow: {
          ...s.workflow,
          edges: [...s.workflow.edges, edge],
        },
      }));

      persist();
    },

    deleteNode: (id) => {
      set((s) => {
        const nodes = s.workflow.nodes.filter((n) => n.id !== id);

        const edges = s.workflow.edges.filter(
          (e) => e.source !== id && e.target !== id,
        );

        return {
          workflow: {
            ...s.workflow,
            nodes,
            edges,
          },

          activeNodeId: null,
          settingsNodeId: null,
        };
      });

      persist();
    },

    deleteEdge: (id) => {
      set((s) => ({
        workflow: {
          ...s.workflow,
          edges: s.workflow.edges.filter((e) => e.id !== id),
        },

        activeEdgeId: null,
      }));

      persist();
    },

    duplicateNode: (id) => {
      set((s) => {
        const node = s.workflow.nodes.find((n) => n.id === id);

        if (!node) return s;

        const copy = {
          id: crypto.randomUUID(),

          type: node.type,

          position: {
            x: node.position.x + 180,
            y: node.position.y + 100,
          },

          data: { ...node.data },
        };

        return {
          workflow: {
            ...s.workflow,
            nodes: [...s.workflow.nodes, copy],
          },
        };
      });

      persist();
    },

    updateNodeData: (id, data) => {
      set((s) => ({
        workflow: {
          ...s.workflow,

          nodes: s.workflow.nodes.map((n) =>
            n.id === id
              ? {
                  ...n,
                  data: {
                    ...n.data,
                    ...data,
                  },
                }
              : n,
          ),
        },
      }));

      persist();
    },

    setWorkflow: (wf) => {
      localStorage.removeItem(KEY);

      set({
        workflow: wf,
        activeNodeId: null,
        activeEdgeId: null,
        settingsNodeId: null,
      });

      save(wf);
    },
  };
});

File: tsconfig.json
------------------------
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts",
    "**/*.mts"
  ],
  "exclude": ["node_modules"]
}

